## ─────────────────────────────────────────────
## Project Root & Directories
## ─────────────────────────────────────────────

export PROJECT_ROOT="$PWD"
export PROJECT_BIN_DIR="$PROJECT_ROOT/bin"
export PROJECT_SCRIPTS_DIR="$PROJECT_ROOT/scripts"
export PROJECT_TARGET_DIR="$PROJECT_ROOT/target"

## ─────────────────────────────────────────────
## XDG Directories (Commented Out for Now)
## ─────────────────────────────────────────────

# export XDG_CONFIG_HOME="$PROJECT_ROOT/config"
# export XDG_CACHE_HOME="$PROJECT_ROOT/cache"
# export XDG_DATA_HOME="$PROJECT_ROOT/share"
# export XDG_STATE_HOME="$PROJECT_ROOT/state"

## ─────────────────────────────────────────────
## Project Binaries & Scripts
## ─────────────────────────────────────────────

add_to_path() {
  [ -d "$1" ] && export PATH="$1:$PATH"
}

add_to_path "$PROJECT_TARGET_DIR/release"
add_to_path "$PROJECT_BIN_DIR"
add_to_path "$PROJECT_SCRIPTS_DIR"

## ─────────────────────────────────────────────
## Rust Environment Setup
## ─────────────────────────────────────────────

export CARGO_TARGET_DIR="$PROJECT_TARGET_DIR"     # Store compiled artifacts within the project
# export RUSTUP_HOME="$PROJECT_ROOT/.rustup"      # Keep Rustup isolated
# export CARGO_HOME="$PROJECT_ROOT/.cargo"        # Keep Cargo binaries and cache inside the project
# add_to_path "$CARGO_HOME/bin"                   # Add Cargo binaries to PATH

export CARGO_INCREMENTAL=1                        # Enable incremental compilation for faster builds
export RUST_ANALYZER_CACHE_DIR="$PROJECT_ROOT/.rust-analyzer" # Rust Analyzer LSP cache

export RUST_BACKTRACE=1                           # Enable backtraces for debugging
export RUST_LOG="debug"                           # Default logging level for Rust apps

# Optimize Rust builds
# export CARGO_PROFILE_RELEASE_LTO=thin
# export RUSTFLAGS="-C target-cpu=native"

## ─────────────────────────────────────────────
## Ruby Environment Setup
## ─────────────────────────────────────────────

export GEM_HOME="$PROJECT_ROOT/.gem"             # Store installed gems locally
export GEM_PATH="$GEM_HOME:$GEM_PATH"            # Ensure Ruby uses local gems
add_to_path "$GEM_HOME/bin"                      # Add local gems to PATH

export BUNDLE_PATH="$GEM_HOME/bundle"            # Keep Bundler dependencies in the project

## ─────────────────────────────────────────────
## Direnv Auto-Reload
## ─────────────────────────────────────────────

# watch_file .envrc
